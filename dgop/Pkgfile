# Description: API & CLI for System Resources
# URL: https://github.com/AvengeMedia/dgop/
# Maintainer: Jay Lanagan, j at lngn dot net
# Depends on: go

name=dgop
version=0.1.1
release=1
source=(https://github.com/AvengeMedia/$name/archive/v${version}/$name-$version.tar.gz)

build() {
  cd $name-$version

  export CGO_CPPFLAGS="${CPPFLAGS}"
  export CGO_CFLAGS="${CFLAGS}"
  export CGO_CXXFLAGS="${CXXFLAGS}"
  export CGO_LDFLAGS="${LDFLAGS}"

  mkdir "$PKGMK_SOURCE_DIR/gopath" || true
  export GOPATH="$PKGMK_SOURCE_DIR/gopath"

  go mod download
  mkdir -p $PKG/usr/bin
  go build -o bin/$name cmd/cli/*.go
  install -Dm755 bin/dgop -t $PKG/usr/bin/
}
